# ================================
# 初春图床系统 / OneImg
# ================================

# --- 基础信息 / Basic Information ---
local app_id="oneimg"
local app_name="初春图床系统"
local app_text="基于Vue3+Go的现代化图床系统，支持POW验证、剪贴板上传等高级功能"
local app_url="https://github.com/onexru/oneimg"
local docker_name="oneimg"
local docker_port="8203"
local app_size="1"

# --- 核心逻辑 / Core Logic ---
docker_app_install() {

    echo "开始安装 初春图床系统 (OneImg)..."

    # 创建数据目录
    mkdir -p /home/docker/oneimg/data

    # 拉取镜像
    docker pull onexru/oneimg-oneimg

    # 启动容器
    docker run -d \
        --name ${docker_name} \
        -p ${docker_port}:8080 \
        -v /home/docker/oneimg/data:/app \
        --restart unless-stopped \
        onexru/oneimg-oneimg

    echo "初春图床系统 安装完成"
    check_docker_app_ip
}

docker_app_update() {

    echo "更新 初春图床系统..."

    # 停止并删除旧容器
    docker stop ${docker_name}
    docker rm ${docker_name}

    # 拉取最新镜像
    docker pull onexru/oneimg-oneimg

    # 重新启动
    docker run -d \
        --name ${docker_name} \
        -p ${docker_port}:8080 \
        -v /home/docker/oneimg/data:/app \
        --restart unless-stopped \
        onexru/oneimg-oneimg

    echo "初春图床系统 更新完成"
}

docker_app_uninstall() {

    echo "卸载 初春图床系统..."

    docker stop ${docker_name}
    docker rm ${docker_name}

    # 删除数据目录
    rm -rf /home/docker/oneimg

    echo "初春图床系统 已卸载"
}

# --- 注册 (必须包含) / Registration ---
docker_app_plus
